<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§°‡§æ‡§Ø‡§®‡§æ‡§Æ‡§ø‡§ï ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§ú‡•á‡§®‡§∞‡•á‡§ü‡§∞</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- PDF ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        :root {
            --light-bg-gradient: linear-gradient(135deg, #6b48ff, #00ddeb);
            --light-container-bg: rgba(255, 255, 255, 0.95);
            --light-text-heading: #2c3e50;
            --light-text-body: #34495e;
            --light-btn-bg: #6b48ff;
            --light-btn-hover-bg: #5c3de6;
            --light-progress-fill: #6b48ff;
            --light-progress-bg: #e0e0e0;

            --dark-bg-gradient: linear-gradient(135deg, #2c3e50, #4b79a1);
            --dark-container-bg: rgba(30, 30, 30, 0.95);
            --dark-text-heading: #e0e0e0;
            --dark-text-body: #bdc3c7;
            --dark-btn-bg: #00ddeb;
            --dark-btn-hover-bg: #00b7c3;
            --dark-progress-fill: #00ddeb;
            --dark-progress-bg: #34495e;

            --correct-color: #2ecc71;
            --incorrect-color: #e74c3c;
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            
            --bg-gradient: var(--light-bg-gradient);
            --container-bg: var(--light-container-bg);
            --text-heading: var(--light-text-heading);
            --text-body: var(--light-text-body);
            --btn-bg: var(--light-btn-bg);
            --btn-hover-bg: var(--light-btn-hover-bg);
            --progress-fill: var(--light-progress-fill);
            --progress-bg: var(--light-progress-bg);
        }

        html[data-theme="dark"] {
            --bg-gradient: var(--dark-bg-gradient);
            --container-bg: var(--dark-container-bg);
            --text-heading: var(--dark-text-heading);
            --text-body: var(--dark-text-body);
            --btn-bg: var(--dark-btn-bg);
            --btn-hover-bg: var(--dark-btn-hover-bg);
            --progress-fill: var(--dark-progress-fill);
            --progress-bg: var(--dark-progress-bg);
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg-gradient); color: var(--text-body); min-height: 100vh; display: flex; flex-direction: column; transition: background 0.3s, color 0.3s; }
        main { padding: 2rem 1rem; flex-grow: 1; }
        .container { max-width: 800px; margin: 2rem auto; background: var(--container-bg); padding: 2rem; border-radius: 16px; box-shadow: var(--shadow); transition: background 0.3s; }
        
        .page-header { background: rgba(255,255,255,0.1); backdrop-filter: blur(5px); padding: 1rem 1.5rem; width: 100%; z-index: 100; position: sticky; top: 0; display: flex; justify-content: space-between; align-items: center; gap: 1rem; }
        .header-left { display: flex; align-items: center; gap: 1rem; }
        .header-left h1 { font-size: 1.5em; color: white; margin: 0; }
        .menu-btn { background: none; border: none; color: white; font-size: 2em; cursor: pointer; z-index: 1001; }
        
        #sidebar-menu { height: 100%; width: 280px; position: fixed; z-index: 1002; top: 0; left: -280px; background-color: var(--container-bg); overflow-x: hidden; transition: 0.3s; padding-top: 60px; box-shadow: 3px 0 15px rgba(0,0,0,0.2); }
        #sidebar-menu a { padding: 12px 16px; text-decoration: none; font-size: 1.1em; color: var(--text-heading); display: block; transition: 0.2s; border-left: 4px solid transparent; }
        #sidebar-menu a:hover { background-color: var(--progress-bg); border-left-color: var(--btn-bg); }
        #sidebar-menu .close-btn { position: absolute; top: 15px; right: 25px; font-size: 36px; margin-left: 50px; color: var(--text-heading); }
        #overlay { position: fixed; display: none; width: 100%; height: 100%; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.5); z-index: 1001; cursor: pointer; }
        
        .search-container { display: flex; align-items: center; width: 90%; }
        .search-container input { padding: 0.5rem 1rem; border-radius: 10px 0 0 20px; border: 1px solid #fff; background: rgba(255,255,255,0.2); color: #fff; font-size: 1em; width: 90%; }
        .search-container input::placeholder { color: rgba(255,255,255,0.8); }
        .search-container button { padding: 0.5rem 1rem; border-radius: 0 10px 20px 0; border: 1px solid #fff; border-left: none; background: #fff; color: var(--light-btn-bg); cursor: pointer; font-weight: 600; }
        
        .header-search { max-width: 450px; }
        .main-search { margin: 1.5rem auto !important; }
        .main-search input { border-color: var(--text-body); background: transparent; color: var(--text-heading); }
        .main-search input::placeholder { color: var(--text-body); opacity: 0.7; }
        .main-search button { border-color: var(--btn-bg); background: var(--btn-bg); color: #fff; }

        #start-screen { text-align: center; }
        #start-screen h2 { font-size: 2em; color: var(--text-heading); margin-bottom: 1rem; }
       
        .popular-topics h3, .test-selector h3 { 
            font-size: 1.5em; color: var(--text-heading); margin-top: 2rem; margin-bottom: 1rem; border-bottom: 2px solid var(--btn-bg); padding-bottom: 0.5rem; display: inline-block; 
        }
        .popular-topics h4, .test-selector h4 { 
            color: var(--text-heading); margin-top: 1.5rem; margin-bottom: 0.75rem; text-align: left; padding-left: 10px; border-left: 3px solid var(--btn-bg); 
        }
        .topic-tags { display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: center; }
        .topic-tag { background: var(--btn-bg); color: white; padding: 0.5rem 1rem; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.2s; }
        .topic-tag:hover { background: var(--btn-hover-bg); transform: scale(1.05); }

        #toggle-exam-list-btn {
            width: 100%;
            margin-top: 1.5rem;
            background-color: var(--btn-hover-bg);
            font-size: 1.1em;
        }
        #exam-list-container {
            border-top: 2px solid var(--progress-bg);
            padding-top: 1.5rem;
            margin-top: 1.5rem;
            text-align: center;
        }

        .quiz-info, .progress-bar-container, .timer, .question-text, .options-grid, .quiz-controls { margin-bottom: 1rem; }
        .quiz-info { display: flex; justify-content: space-between; font-weight: 600; color: var(--text-heading); }
        .progress-bar-container { width: 100%; background-color: var(--progress-bg); border-radius: 10px; height: 10px; }
        .progress-bar { height: 100%; width: 0%; background-color: var(--progress-fill); border-radius: 10px; transition: width 0.3s ease-in-out; }
        .timer { font-size: 1.5em; font-weight: 700; text-align: center; color: var(--text-heading); }
        .question-text { font-size: 1.3em; font-weight: 600; text-align: center; min-height: 50px; line-height: 1.4; }
        .options-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
        .option { background-color: var(--progress-bg); border: 2px solid transparent; border-radius: 8px; padding: 1rem; cursor: pointer; transition: all 0.2s; user-select: none; text-align: center; font-weight: 500; }
        .option:hover:not(.disabled) { transform: translateY(-3px); border-color: var(--btn-bg); box-shadow: 0 4px 12px rgba(107, 72, 255, 0.3); }
        .option.correct { background-color: var(--correct-color); color: #fff; border-color: var(--correct-color); }
        .option.incorrect { background-color: var(--incorrect-color); color: #fff; border-color: var(--incorrect-color); }
        .option.disabled { pointer-events: none; opacity: 0.7; }
        .quiz-controls { display: flex; justify-content: space-between; align-items: center; }
        .quiz-controls > div { display: flex; gap: 0.5rem; }
        .btn { padding: 0.8rem 1.5rem; border: none; border-radius: 8px; background-color: var(--btn-bg); color: #fff; font-size: 1em; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn:hover { background-color: var(--btn-hover-bg); transform: translateY(-2px); }
        .btn:disabled { background-color: #bdc3c7; cursor: not-allowed; transform: none; }
        #result-container { display: none; text-align: center; }
        .result-buttons { display: flex; justify-content: center; gap: 1rem; margin-top: 1.5rem; }

        .modal { display: none; position: fixed; z-index: 1003; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); }
        .modal-content { background-color: var(--container-bg); margin: 10% auto; padding: 20px; border: 1px solid #888; width: 90%; max-width: 700px; border-radius: 12px; color: var(--text-body); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--progress-bg); padding-bottom: 10px; margin-bottom: 15px; }
        .modal-header h2 { color: var(--text-heading); }
        .close-modal { color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; }
        
        #history-search-bar { width: 100%; padding: 8px; margin-bottom: 15px; border-radius: 6px; border: 1px solid var(--progress-bg); background-color: transparent; color: var(--text-body); }
        #history-list { max-height: 400px; overflow-y: auto; padding-right: 5px; }
        #history-list li { background-color: var(--progress-bg); padding: 10px 15px; border-radius: 6px; margin-bottom: 8px; list-style-type: none; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        .history-item-info { display: flex; flex-direction: column; }
        .history-item-info span:first-child { font-weight: bold; }
        .download-history-pdf-btn { padding: 5px 10px; font-size: 0.8em; }

        @media (max-width: 768px) { 
            .header-search { display: none; }
            .header-left h1 { font-size: 1.2em; }
            .options-grid { grid-template-columns: 1fr; } 
        }
        @media (min-width: 769px) {
            .main-search { display: none; }
        }
    </style>
</head>
<body>
    <div id="sidebar-menu">
        <a href="javascript:void(0)" class="close-btn" id="close-menu-btn">√ó</a>
        <a href="#" id="history-btn">üìú ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</a>
        <a href="#" id="share-app-btn">üîó ‡§ê‡§™ ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç</a>
        <div class="theme-switcher" style="padding: 15px;">
            <label>‡§•‡•Ä‡§Æ ‡§¨‡§¶‡§≤‡•á‡§Ç:</label>
            <input type="checkbox" id="theme-toggle">
        </div>
    </div>
    <div id="overlay"></div>

    <header class="page-header">
        <div class="header-left">
            <button class="menu-btn" id="open-menu-btn">‚ò∞</button>
            <h1>Quiz</h1>
            <div class="search-container main-search">
                <input type="search" id="main-search-bar" placeholder="‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§µ‡§ø‡§∑‡§Ø ‡§ñ‡•ã‡§ú‡•á‡§Ç...">
                <button id="main-search-btn">‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§¨‡§®‡§æ‡§è‡§Ç</button>
            </div>
        </div>
        <div class="search-container header-search">
             <input type="search" id="header-search-bar" placeholder="‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§µ‡§ø‡§∑‡§Ø ‡§ñ‡•ã‡§ú‡•á‡§Ç...">
             <button id="header-search-btn">‡§¨‡§®‡§æ‡§è‡§Ç</button>
        </div>
    </header>

    <marquee behavior="scroll" direction="left"> ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä Exam ‡§ï‡•Ä quiz ‡§ü‡•á‡§∏‡•ç‡§ü ‡§¶‡•á ‡§∏‡§ï‡§§‡•á ‡§π‡•à,‡§¨‡§∏ ‡§Ü‡§™ ‡§ï‡•ã‡§®‡§∏‡§æ Exam quiz ‡§ñ‡•á‡§≤‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à ‡§≤‡§ø‡§ñ‡•á,, ‡§ú‡•à‡§∏‡•á ‡§ï‡•Ä, Cg police upsc, cgpsc, ‡§ï‡•Å‡§õ ‡§≠‡•Ä ‡§≤‡§ø‡§ñ‡•á ‡§Ü‡§™‡§ï‡•ã quiz ‡§ü‡•á‡§∏‡•ç‡§ü ‡§¨‡§®‡§æ ‡§ï‡§∞ ‡§¶‡•á ‡§¶‡•á‡§ó‡§æ,   </marquee>

    <main>
        <div id="quiz-wrapper" class="container">
            
            <div id="start-screen">
               <div class="difficulty-selector" style="margin-bottom: 2rem;">
                    <label for="difficulty">‡§ï‡§†‡§ø‡§®‡§æ‡§à ‡§∏‡•ç‡§§‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç: </label>
                    <select id="difficulty" style="padding: 5px; border-radius: 5px;">
                        <option value="‡§Ü‡§∏‡§æ‡§®">‡§Ü‡§∏‡§æ‡§®</option>
                        <option value="‡§Æ‡§ß‡•ç‡§Ø‡§Æ" selected>‡§Æ‡§ß‡•ç‡§Ø‡§Æ</option>
                        <option value="‡§ï‡§†‡§ø‡§®">‡§ï‡§†‡§ø‡§®</option>
                    </select>
                </div>

                <button id="toggle-exam-list-btn" class="btn">üìù ‡§™‡•ç‡§∞‡§§‡§ø‡§Ø‡•ã‡§ó‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ü‡•á‡§∏‡•ç‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç</button>

                <div id="exam-list-container" style="display: none;">
                    <div class="test-selector">
                        <h4>‡§™‡•Å‡§≤‡§ø‡§∏ ‡§≠‡§∞‡•ç‡§§‡•Ä</h4>
                        <div class="topic-tags">
                            <span class="topic-tag" data-topic="cg police">CG Police</span>
                            <span class="topic-tag" data-topic="up police">UP Police</span>
                            <span class="topic-tag" data-topic="mp police">MP Police</span>
                            <span class="topic-tag" data-topic="bihar police">Bihar Police</span>
                            <span class="topic-tag" data-topic="delhi police">Delhi Police</span>
                        </div>
                        
                        <h4>‡§∏‡§ø‡§µ‡§ø‡§≤ ‡§∏‡•á‡§µ‡§æ</h4>
                        <div class="topic-tags">
                            <span class="topic-tag" data-topic="upsc">UPSC</span>
                            <span class="topic-tag" data-topic="cgpsc">CGPSC</span>
                            <span class="topic-tag" data-topic="uppsc">UPPSC</span>
                            <span class="topic-tag" data-topic="mppsc">MPPSC</span>
                            <span class="topic-tag" data-topic="bpsc">BPSC</span>
                        </div>
                        
                        <h4>‡§∞‡•á‡§≤‡§µ‡•á ‡§≠‡§∞‡•ç‡§§‡•Ä</h4>
                        <div class="topic-tags">
                            <span class="topic-tag" data-topic="rrb ntpc">RRB NTPC</span>
                            <span class="topic-tag" data-topic="rrb group d">RRB Group D</span>
                            <span class="topic-tag" data-topic="rrb je">RRB JE</span>
                            <span class="topic-tag" data-topic="rrb alp">RRB ALP</span>
                        </div>
                        
                        <h4>SSC ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ‡§è‡§Ç</h4>
                        <div class="topic-tags">
                            <span class="topic-tag" data-topic="ssc gd">SSC GD</span>
                            <span class="topic-tag" data-topic="ssc cgl">SSC CGL</span>
                            <span class="topic-tag" data-topic="ssc chsl">SSC CHSL</span>
                            <span class="topic-tag" data-topic="ssc mts">SSC MTS</span>
                        </div>
                        
                        <h4>‡§Ö‡§®‡•ç‡§Ø ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£</h4>
                        <div class="topic-tags">
                            <span class="topic-tag" data-topic="‡§¨‡•à‡§Ç‡§ï‡§ø‡§Ç‡§ó">‡§¨‡•à‡§Ç‡§ï‡§ø‡§Ç‡§ó</span>
                            <span class="topic-tag" data-topic="ctet">CTET</span>
                            <span class="topic-tag" data-topic="nda">NDA</span>
                            <span class="topic-tag" data-topic="isro">ISRO</span>
                        </div>
                    </div>
                </div>

                  <div class="popular-topics">
                    <h3>üî• ‡§≤‡•ã‡§ï‡§™‡•ç‡§∞‡§ø‡§Ø ‡§µ‡§ø‡§∑‡§Ø:</h3>
                    <h4>‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§µ‡§ø‡§∑‡§Ø</h4>
                    <div class="topic-tags">
                        <span class="topic-tag" data-topic="‡§ó‡§£‡§ø‡§§">‡§ó‡§£‡§ø‡§§</span>
                        <span class="topic-tag" data-topic="‡§∞‡•Ä‡§ú‡§®‡§ø‡§Ç‡§ó">‡§∞‡•Ä‡§ú‡§®‡§ø‡§Ç‡§ó</span>
                        <span class="topic-tag" data-topic="‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®">‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®</span>
                        <span class="topic-tag" data-topic="‡§≠‡•Ç‡§ó‡•ã‡§≤">‡§≠‡•Ç‡§ó‡•ã‡§≤</span>
                        <span class="topic-tag" data-topic="‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§∏‡§æ‡§á‡§Ç‡§∏">‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§∏‡§æ‡§á‡§Ç‡§∏</span>
                        <span class="topic-tag" data-topic="‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞">‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞</span>
                    </div>
                    <h4>‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§î‡§∞ ‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø</h4>
                    <div class="topic-tags">
                        <span class="topic-tag" data-topic="‡§≠‡§æ‡§∞‡§§ ‡§ï‡§æ ‡§á‡§§‡§ø‡§π‡§æ‡§∏">‡§≠‡§æ‡§∞‡§§ ‡§ï‡§æ ‡§á‡§§‡§ø‡§π‡§æ‡§∏</span>
                        <span class="topic-tag" data-topic="‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§®">‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§®</span>
                        <span class="topic-tag" data-topic="‡§∏‡•ç‡§µ‡§§‡§Ç‡§§‡•ç‡§∞‡§§‡§æ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§æ‡§Æ">‡§∏‡•ç‡§µ‡§§‡§Ç‡§§‡•ç‡§∞‡§§‡§æ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§æ‡§Æ</span>
                        <span class="topic-tag" data-topic="‡§Æ‡•Å‡§ó‡§≤ ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø">‡§Æ‡•Å‡§ó‡§≤ ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø</span>
                        <span class="topic-tag" data-topic="‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®">‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®</span>
                        <span class="topic-tag" data-topic="‡§Æ‡§π‡§æ‡§§‡•ç‡§Æ‡§æ ‡§ó‡§æ‡§Ç‡§ß‡•Ä">‡§Æ‡§π‡§æ‡§§‡•ç‡§Æ‡§æ ‡§ó‡§æ‡§Ç‡§ß‡•Ä</span>
                    </div>
                    <h4>‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ú‡•ç‡§û‡§æ‡§® ‡§î‡§∞ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø</h4>
                    <div class="topic-tags">
                        <span class="topic-tag" data-topic="‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ú‡•ç‡§û‡§æ‡§®">‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ú‡•ç‡§û‡§æ‡§®</span>
                        <span class="topic-tag" data-topic="‡§ï‡§∞‡§Ç‡§ü ‡§Ö‡§´‡•á‡§Ø‡§∞‡•ç‡§∏">‡§ï‡§∞‡§Ç‡§ü ‡§Ö‡§´‡•á‡§Ø‡§∞‡•ç‡§∏</span>
                        <span class="topic-tag" data-topic="‡§ñ‡•á‡§≤">‡§ñ‡•á‡§≤</span>
                        <span class="topic-tag" data-topic="‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§∏‡§æ‡§π‡§ø‡§§‡•ç‡§Ø">‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§∏‡§æ‡§π‡§ø‡§§‡•ç‡§Ø</span>
                        <span class="topic-tag" data-topic="‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§ï‡§≤‡§æ">‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§ï‡§≤‡§æ</span>
                        <span class="topic-tag" data-topic="‡§¨‡•â‡§≤‡•Ä‡§µ‡•Å‡§°">‡§¨‡•â‡§≤‡•Ä‡§µ‡•Å‡§°</span>
                        <span class="topic-tag" data-topic="‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£">‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£</span>
                        <span class="topic-tag" data-topic="‡§Ü‡§Ø‡•Å‡§∞‡•ç‡§µ‡•á‡§¶">‡§Ü‡§Ø‡•Å‡§∞‡•ç‡§µ‡•á‡§¶</span>
                    </div>
                </div>
            </div>
            
            <div id="quiz-container" style="display: none;"></div>
            <div id="result-container" style="display: none;"></div>


           </div>
    </main>

    <!-- History Modal -->
    <div id="history-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìú ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</h2>
                <span class="close-modal" id="close-history-modal">√ó</span>
            </div>
            <input type="search" id="history-search-bar" placeholder="‡§µ‡§ø‡§∑‡§Ø ‡§∏‡•á ‡§ñ‡•ã‡§ú‡•á‡§Ç...">
            <ul id="history-list"></ul>
        </div>
    </div>




<button id="button1" onclick="myFunction()"> 
  <script type="text/javascript">
	atOptions = {
		'key' : 'dfb9f45a0bfc2772a4f0f47ce1391707',
		'format' : 'iframe',
		'height' : 50,
		'width' : 320,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/dfb9f45a0bfc2772a4f0f47ce1391707/invoke.js"></script>
</button>



<script>
document.addEventListener('DOMContentLoaded', () => {
    // DOM Elements
    const headerSearchBar = document.getElementById('header-search-bar');
    const headerSearchBtn = document.getElementById('header-search-btn');
    const mainSearchBar = document.getElementById('main-search-bar');
    const mainSearchBtn = document.getElementById('main-search-btn');
    const startScreen = document.getElementById('start-screen');
    const quizContainer = document.getElementById('quiz-container');
    const resultContainer = document.getElementById('result-container');
    const difficultySelect = document.getElementById('difficulty');
    const themeToggle = document.getElementById('theme-toggle');
    const toggleExamListBtn = document.getElementById('toggle-exam-list-btn');
    const examListContainer = document.getElementById('exam-list-container');
    const openMenuBtn = document.getElementById('open-menu-btn');
    const closeMenuBtn = document.getElementById('close-menu-btn');
    const sidebarMenu = document.getElementById('sidebar-menu');
    const overlay = document.getElementById('overlay');
    const historyBtn = document.getElementById('history-btn');
    const shareAppBtn = document.getElementById('share-app-btn');
    const historyModal = document.getElementById('history-modal');
    const closeHistoryModal = document.getElementById('close-history-modal');
    const historyList = document.getElementById('history-list');
    const historySearchBar = document.getElementById('history-search-bar');
    
    // API Key
    const API_KEY = "AIzaSyDHy9J04dI8LdK1ijNJMrRXubJ5ucx9rdk"; // ‡§Ö‡§™‡§®‡•Ä Gemini API ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§Ø‡§π‡§æ‡§Å ‡§°‡§æ‡§≤‡•á‡§Ç

    // Quiz State
    let currentQuestionIndex = 0;
    let currentQuizQuestions = [];
    let currentTopic = "";
    let currentDifficulty = "";
    let timer;
    let timeLeft = 20;

    // Event Listeners
    function triggerSearch(inputElement) {
        const topic = inputElement.value.trim();
        if (topic) {
            handleSearch(topic);
        } else {
            alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§µ‡§ø‡§∑‡§Ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§');
        }
    }

    headerSearchBtn.addEventListener('click', () => triggerSearch(headerSearchBar));
    headerSearchBar.addEventListener('keydown', (e) => { if (e.key === 'Enter') triggerSearch(headerSearchBar); });
    mainSearchBtn.addEventListener('click', () => triggerSearch(mainSearchBar));
    mainSearchBar.addEventListener('keydown', (e) => { if (e.key === 'Enter') triggerSearch(mainSearchBar); });
    
    startScreen.addEventListener('click', (e) => {
        if (e.target.classList.contains('topic-tag')) {
            const topic = e.target.dataset.topic;
            headerSearchBar.value = topic;
            mainSearchBar.value = topic;
            handleSearch(topic);
        }
    });

    toggleExamListBtn.addEventListener('click', () => {
        const isHidden = examListContainer.style.display === 'none' || examListContainer.style.display === '';
        examListContainer.style.display = isHidden ? 'block' : 'none';
        toggleExamListBtn.textContent = isHidden ? '‡§™‡•ç‡§∞‡§§‡§ø‡§Ø‡•ã‡§ó‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ç‡§ö‡•Ä ‡§õ‡§ø‡§™‡§æ‡§è‡§Ç' : 'üìù ‡§™‡•ç‡§∞‡§§‡§ø‡§Ø‡•ã‡§ó‡•Ä ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ü‡•á‡§∏‡•ç‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç';
    });

    const toggleMenu = (show) => {
        sidebarMenu.style.left = show ? '0' : '-280px';
        overlay.style.display = show ? 'block' : 'none';
    };
    openMenuBtn.addEventListener('click', () => toggleMenu(true));
    closeMenuBtn.addEventListener('click', () => toggleMenu(false));
    overlay.addEventListener('click', () => toggleMenu(false));
    shareAppBtn.addEventListener('click', shareApp);
    historyBtn.addEventListener('click', () => { displayHistory(); toggleMenu(false); });
    closeHistoryModal.addEventListener('click', () => historyModal.style.display = 'none');
    window.addEventListener('click', (event) => { if (event.target == historyModal) historyModal.style.display = "none"; });

    historySearchBar.addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        historyList.querySelectorAll('li').forEach(item => {
            const topic = item.querySelector('.history-item-info span:first-child').textContent.toLowerCase();
            item.style.display = topic.includes(searchTerm) ? 'flex' : 'none';
        });
    });

    historyList.addEventListener('click', (e) => {
        if (e.target.classList.contains('download-history-pdf-btn')) {
            const quizId = e.target.closest('li').dataset.quizId;
            downloadHistoryAsPDF(quizId);
        }
    });

    // --- Core Functions ---
    function handleSearch(topic) {
        if (!API_KEY || !API_KEY.startsWith("AIzaS")) {
            alert("API ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§∏‡§π‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•ã‡§° ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç‡•§");
            return;
        }
        currentTopic = topic;
        currentDifficulty = difficultySelect.value;
        generateQuizFromTopic(currentTopic, currentDifficulty);
    }

    async function generateQuizFromTopic(topic, difficulty) {
        startScreen.style.display = 'none';
        resultContainer.innerHTML = '';
        resultContainer.style.display = 'none';
        quizContainer.innerHTML = `<div style="text-align: center; font-size: 1.2em;">üß† ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>`;
        quizContainer.style.display = 'block';

        const model = "gemini-1.5-flash";
        const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${API_KEY}`;
        
        const prompt = `"${topic}" ‡§µ‡§ø‡§∑‡§Ø ‡§™‡§∞ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç 20 ‡§¨‡§π‡•Å‡§µ‡§ø‡§ï‡§≤‡•ç‡§™‡•Ä‡§Ø ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§ï‡§æ ‡§è‡§ï **‡§®‡§Ø‡§æ ‡§î‡§∞ ‡§Ö‡§®‡•ã‡§ñ‡§æ** ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§¨‡§®‡§æ‡§è‡§Ç‡•§ ‡§ï‡§†‡§ø‡§®‡§æ‡§à ‡§ï‡§æ ‡§∏‡•ç‡§§‡§∞ "${difficulty}" ‡§π‡•ã‡•§ ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§ï‡•á‡§µ‡§≤ JSON ‡§™‡•ç‡§∞‡§æ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§Ç, ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç "quiz" ‡§®‡§æ‡§Æ‡§ï ‡§è‡§ï ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§π‡•ã ‡§ú‡•ã ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü‡•ç‡§∏ ‡§ï‡•Ä ‡§è‡§ï ‡§ê‡§∞‡•á ‡§π‡•ã‡•§ ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§Æ‡•á‡§Ç "question", "options" (4 ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§ï‡•Ä ‡§ê‡§∞‡•á), "answer", ‡§î‡§∞ "hint" ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§ JSON ‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ ‡§ï‡•ã‡§à ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§`;

        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: prompt }] }],
                    generationConfig: {
                        temperature: 0.9
                    }
                }),
            });

            if (!response.ok) throw new Error(`API Error: ${response.status} ${response.statusText}`);
            
            const data = await response.json();
            if (!data.candidates || !data.candidates[0].content) {
                if (data.error) throw new Error(`API Error: ${data.error.message}`);
                throw new Error('API ‡§∏‡•á ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡§ø‡§≤‡•Ä‡•§');
            }
            
            let text = data.candidates[0].content.parts[0].text.replace(/```json/g, '').replace(/```/g, '').trim();
            const quizData = JSON.parse(text);

            if (!quizData.quiz || quizData.quiz.length === 0) throw new Error('AI ‡§∏‡•á ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§');
            
            currentQuizQuestions = quizData.quiz;
            startQuiz();

        } catch (error) {
            console.error('‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§¨‡§®‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§´‡§≤:', error);
            alert(`‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§¨‡§®‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§´‡§≤: ${error.message}\n‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ API ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç‡•§`);
            startScreen.style.display = 'block';
            quizContainer.style.display = 'none';
        }
    }

    function startQuiz() {
        currentQuestionIndex = 0;
        currentQuizQuestions.forEach(q => {
            q.userAnswer = null;
            q.isCorrect = false;
        }); 
        showQuestion();
    }

    function showQuestion() {
        clearInterval(timer); 

        if (currentQuestionIndex >= currentQuizQuestions.length) {
            showResults();
            return;
        }

        const questionData = currentQuizQuestions[currentQuestionIndex];
        const score = calculateScore();

        quizContainer.innerHTML = `
            <div class="quiz-info">
                <span>‡§µ‡§ø‡§∑‡§Ø: ${currentTopic}</span>
                <span>‡§™‡•ç‡§∞‡§∂‡•ç‡§®: ${currentQuestionIndex + 1}/${currentQuizQuestions.length}</span>
                <span>‡§∏‡•ç‡§ï‡•ã‡§∞: ${score}</span>
            </div>
            <div class="progress-bar-container"><div class="progress-bar" style="width: ${((currentQuestionIndex + 1) / currentQuizQuestions.length) * 100}%"></div></div>
            <div class="timer" id="timer-display"></div>
            <div id="quiz-content">
                <p class="question-text">${questionData.question}</p>
                <div class="options-grid">
                    ${questionData.options.map(opt => `<div class="option" data-answer="${opt}">${opt}</div>`).join('')}
                </div>
                <div class="quiz-controls">
                    <div>
                        <button id="back-btn-q" class="btn">‚¨ÖÔ∏è ‡§™‡§ø‡§õ‡§≤‡§æ</button>
                        <button id="hint-btn-q" class="btn">üí° ‡§∏‡§Ç‡§ï‡•á‡§§</button>
                    </div>
                    <button id="next-btn-q" class="btn">‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡•á‡§Ç ‚û°Ô∏è</button>
                </div>
            </div>`;
        
        const nextBtn = document.getElementById('next-btn-q');
        const backBtn = document.getElementById('back-btn-q');
        const hintBtn = document.getElementById('hint-btn-q');
        
        nextBtn.addEventListener('click', () => { currentQuestionIndex++; showQuestion(); });
        backBtn.addEventListener('click', () => { if (currentQuestionIndex > 0) { currentQuestionIndex--; showQuestion(); } });
        hintBtn.addEventListener('click', () => showHint(questionData));
        
        backBtn.style.display = currentQuestionIndex > 0 ? 'inline-block' : 'none';
        nextBtn.style.display = 'none';

        if (questionData.userAnswer) {
            restoreAnsweredState(questionData);
        } else {
            document.querySelectorAll('.option').forEach(opt => opt.addEventListener('click', (e) => selectOption(e.target, questionData)));
            startTimer(questionData);
        }
    }
    
    function selectOption(selectedOption, questionData) {
        clearInterval(timer);
        questionData.userAnswer = selectedOption.dataset.answer;
        questionData.isCorrect = questionData.userAnswer === questionData.answer;
        restoreAnsweredState(questionData);
    }

    function restoreAnsweredState(questionData) {
        document.getElementById('timer-display').innerHTML = '‚úîÔ∏è ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ';
        document.querySelectorAll('.option').forEach(option => {
            option.classList.add('disabled');
            if (option.dataset.answer === questionData.answer) option.classList.add('correct');
            if (option.dataset.answer === questionData.userAnswer && !questionData.isCorrect) option.classList.add('incorrect');
        });
        document.getElementById('hint-btn-q').style.display = 'none';
        document.getElementById('next-btn-q').style.display = 'block';
        document.querySelector('.quiz-info span:last-child').textContent = `‡§∏‡•ç‡§ï‡•ã‡§∞: ${calculateScore()}`;
    }

    function calculateScore() {
        return currentQuizQuestions.reduce((total, q) => q.isCorrect ? total + 10 : total, 0);
    }

    function startTimer(questionData) {
        timeLeft = 20;
        const timerDisplay = document.getElementById('timer-display');
        timerDisplay.textContent = `‚è∞ ${timeLeft}`;
        timerDisplay.style.color = 'var(--text-heading)';
        timer = setInterval(() => {
            timeLeft--;
            timerDisplay.textContent = `‚è∞ ${timeLeft}`;
            if (timeLeft <= 5) timerDisplay.style.color = 'var(--incorrect-color)';
            if (timeLeft <= 0) {
                clearInterval(timer);
                timeUp(questionData);
            }
        }, 1000);
    }

    function timeUp(questionData) {
        questionData.userAnswer = '‡§∏‡§Æ‡§Ø ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§';
        questionData.isCorrect = false;
        restoreAnsweredState(questionData);
    }

    function showHint(questionData) {
        alert(`‡§∏‡§Ç‡§ï‡•á‡§§: ${questionData.hint || '‡§ï‡•ã‡§à ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§'}`);
        document.getElementById('hint-btn-q').disabled = true;
    }

    function showResults() {
        quizContainer.style.display = 'none';
        const finalScore = calculateScore();
        const totalScore = currentQuizQuestions.length * 10;
        const incorrectAnswers = currentQuizQuestions.filter(q => !q.isCorrect && q.userAnswer);
        const percentage = totalScore > 0 ? (finalScore / totalScore) * 100 : 0;
        let perfMessage = (percentage >= 80) ? "‡§¨‡§π‡•Å‡§§ ‡§¨‡§¢‡§º‡§ø‡§Ø‡§æ! ‡§Ü‡§™‡§®‡•á ‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§ï‡§ø‡§Ø‡§æ‡•§" : (percentage >= 50) ? "‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏! ‡§Ü‡§™ ‡§î‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§" : "‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç!";
        let perfColor = (percentage >= 80) ? 'var(--correct-color)' : (percentage >= 50) ? '#f39c12' : 'var(--incorrect-color)';

        resultContainer.innerHTML = `
            <h2>üéâ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§™‡•Ç‡§∞‡§æ ‡§π‡•Å‡§Ü!</h2>
            <div>‡§Ü‡§™‡§ï‡§æ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§∏‡•ç‡§ï‡•ã‡§∞: <strong>${finalScore}/${totalScore}</strong></div>
            <div style="margin: 1rem 0; font-size: 1.2em; font-weight: 600; color: ${perfColor};">${perfMessage}</div>
            <h3>üìù ‡§ó‡§≤‡§§ ‡§â‡§§‡•ç‡§§‡§∞‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Æ‡•Ä‡§ï‡•ç‡§∑‡§æ:</h3>
            <ul style="list-style: none; padding: 0;">
                ${incorrectAnswers.length > 0 ? incorrectAnswers.map(item => `<li style="margin-bottom: 10px; padding: 10px; background-color: var(--progress-bg); border-radius: 6px; text-align: left;"><strong>‡§™‡•ç‡§∞‡§∂‡•ç‡§®:</strong> ${item.question}<br><strong>‡§Ü‡§™‡§ï‡§æ ‡§â‡§§‡•ç‡§§‡§∞:</strong> <span style="color: var(--incorrect-color);">${item.userAnswer}</span><br><strong>‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞:</strong> <span style="color: var(--correct-color);">${item.answer}</span></li>`).join('') : '<li>‡§µ‡§æ‡§π! ‡§Ü‡§™‡§®‡•á ‡§ï‡•ã‡§à ‡§ó‡§≤‡§§‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§ï‡•Ä‡•§</li>'}
            </ul>
            <div class="result-buttons">
                <button id="restart-btn-res" class="btn">üîÑ ‡§®‡§Ø‡§æ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º</button>
                <button id="share-result-btn-res" class="btn">üîó ‡§∞‡§ø‡§ú‡§≤‡•ç‡§ü ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
                <button id="download-pdf-btn-res" class="btn">üìÑ PDF ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</button>
            </div>`;
        
        resultContainer.style.display = 'block';

        document.getElementById('restart-btn-res').addEventListener('click', () => {
            resultContainer.style.display = 'none';
            startScreen.style.display = 'block';
            headerSearchBar.value = '';
            mainSearchBar.value = '';
        });
        document.getElementById('share-result-btn-res').addEventListener('click', () => shareResults(finalScore, totalScore));
        document.getElementById('download-pdf-btn-res').addEventListener('click', () => downloadResultsAsPDF(resultContainer));
        
        saveQuizToHistory();
    }
    
    function saveQuizToHistory() {
        let history = JSON.parse(localStorage.getItem('quizHistory')) || [];
        history.unshift({
            id: Date.now(),
            topic: currentTopic,
            difficulty: currentDifficulty,
            finalScore: calculateScore(),
            totalScore: currentQuizQuestions.length * 10,
            date: new Date().toLocaleDateString('hi-IN'),
            questions: currentQuizQuestions
        });
        if (history.length > 30) history.pop();
        localStorage.setItem('quizHistory', JSON.stringify(history));
    }

    function displayHistory() {
        let history = JSON.parse(localStorage.getItem('quizHistory')) || [];
        historyList.innerHTML = history.length === 0 ? '<li>‡§ï‡•ã‡§à ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</li>' :
            history.map(item => `
                <li data-quiz-id="${item.id}">
                    <div class="history-item-info">
                        <span>${item.topic} (${item.difficulty})</span>
                        <span style="font-size: 0.9em;">‡§∏‡•ç‡§ï‡•ã‡§∞: ${item.finalScore}/${item.totalScore} - ${item.date}</span>
                    </div>
                    <button class="btn download-history-pdf-btn">üìÑ PDF</button>
                </li>
            `).join('');
        historyModal.style.display = 'block';
        historySearchBar.value = "";
    }

    // --- ‡§®‡§Ø‡§æ ‡§î‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ ‡§Æ‡§≤‡•ç‡§ü‡•Ä-‡§™‡•á‡§ú PDF ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ---
    function generateMultiPagePDF(elementToCapture, filename) {
        const { jsPDF } = window.jspdf;
        const clone = elementToCapture.cloneNode(true);

        // PDF ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ç‡§≤‡•ã‡§® ‡§ï‡•ã ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ ‡§ï‡§∞‡•á‡§Ç
        clone.style.width = '180mm';
        clone.style.padding = '10mm';
        clone.style.color = '#000000';
        clone.style.backgroundColor = '#ffffff';
        clone.style.boxSizing = 'border-box';
        clone.querySelectorAll('*').forEach(el => {
            el.style.color = '#000000';
            if (el.style.backgroundColor) {
                el.style.backgroundColor = 'transparent';
            }
        });

        document.body.appendChild(clone);

        html2canvas(clone, { scale: 2, useCORS: true, logging: false })
            .then(canvas => {
                document.body.removeChild(clone);

                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                const canvasWidth = canvas.width;
                const canvasHeight = canvas.height;
                const ratio = canvasWidth / canvasHeight;
                const imgHeightInPDF = pdfWidth / ratio;

                let heightLeft = imgHeightInPDF;
                let position = 0;

                pdf.addImage(imgData, 'PNG', 0, position, pdfWidth, imgHeightInPDF);
                heightLeft -= pdfHeight;

                while (heightLeft >= 0) {
                    position = -heightLeft;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, pdfWidth, imgHeightInPDF);
                    heightLeft -= pdfHeight;
                }
                
                pdf.save(`${filename.replace(/ /g, '_')}.pdf`);
            })
            .catch(err => {
                console.error("PDF ‡§¨‡§®‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø:", err);
                alert("PDF ‡§¨‡§®‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡•Å‡§à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§");
                if (document.body.contains(clone)) {
                    document.body.removeChild(clone);
                }
            });
    }
    
    // ‡§Ø‡§π ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§Ö‡§¨ ‡§®‡§è ‡§π‡•á‡§≤‡•ç‡§™‡§∞ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§ó‡§æ
    function downloadResultsAsPDF(elementToCapture) {
        const pdfFilename = `Quiz_Results_${currentTopic}`;
        generateMultiPagePDF(elementToCapture, pdfFilename);
    }
    
    // ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§µ‡§æ‡§≤‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§≠‡•Ä ‡§Ö‡§¨ ‡§®‡§è ‡§π‡•á‡§≤‡•ç‡§™‡§∞ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§ó‡§æ
    function downloadHistoryAsPDF(quizId) {
        const quizData = (JSON.parse(localStorage.getItem('quizHistory')) || []).find(q => q.id == quizId);
        if (!quizData) return alert('‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§∏‡•á ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§');

        const unanswered = quizData.questions.filter(q => !q.userAnswer);
        const incorrect = quizData.questions.filter(q => !q.isCorrect && q.userAnswer);
        const correct = quizData.questions.filter(q => q.isCorrect);

        const tempContainer = document.createElement('div');
        tempContainer.innerHTML = `
            <div style="font-family: 'Poppins', sans-serif; font-size: 12px; line-height: 1.6;">
                <h2 style="font-size: 20px; border-bottom: 2px solid #ccc; padding-bottom: 5px; margin-bottom: 10px;">‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ: ${quizData.topic}</h2>
                <p><strong>‡§ï‡§†‡§ø‡§®‡§æ‡§à:</strong> ${quizData.difficulty} | <strong>‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï:</strong> ${quizData.date}</p>
                <p style="font-size: 16px; font-weight: 600;">‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§∏‡•ç‡§ï‡•ã‡§∞: ${quizData.finalScore} / ${quizData.totalScore}</p>
                <hr style="margin: 15px 0;">
                <h3 style="font-size: 16px; margin-top: 20px;">‡§ó‡§≤‡§§ ‡§â‡§§‡•ç‡§§‡§∞ (${incorrect.length}):</h3>
                ${incorrect.length > 0 ? incorrect.map(item => `<div style="margin-bottom: 12px; padding: 8px; border-left: 3px solid #e74c3c;"><strong>‡§™‡•ç‡§∞‡§∂‡•ç‡§®:</strong> ${item.question}<br><strong>‡§Ü‡§™‡§ï‡§æ ‡§â‡§§‡•ç‡§§‡§∞:</strong> ${item.userAnswer}<br><strong>‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞:</strong> ${item.answer}</div>`).join('') : '<p>‡§ï‡•ã‡§à ‡§â‡§§‡•ç‡§§‡§∞ ‡§ó‡§≤‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§•‡§æ‡•§</p>'}
                <h3 style="font-size: 16px; margin-top: 20px;">‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞ (${correct.length}):</h3>
                ${correct.length > 0 ? correct.map(item => `<div style="margin-bottom: 12px; padding: 8px; border-left: 3px solid #2ecc71;"><strong>‡§™‡•ç‡§∞‡§∂‡•ç‡§®:</strong> ${item.question}<br><strong>‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞:</strong> ${item.answer}</div>`).join('') : ''}
                <h3 style="font-size: 16px; margin-top: 20px;">‡§¨‡§ø‡§®‡§æ ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡§ø‡§è ‡§ó‡§è ‡§™‡•ç‡§∞‡§∂‡•ç‡§® (${unanswered.length}):</h3>
                ${unanswered.length > 0 ? unanswered.map(item => `<div style="margin-bottom: 12px; padding: 8px; border-left: 3px solid #f39c12;"><strong>‡§™‡•ç‡§∞‡§∂‡•ç‡§®:</strong> ${item.question}<br><strong>‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞:</strong> ${item.answer}</div>`).join('') : '<p>‡§∏‡§≠‡•Ä ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§ï‡•á ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡§ø‡§è ‡§ó‡§è‡•§</p>'}
            </div>`;
        
        const pdfFilename = `${quizData.topic}_${quizData.date}`;
        generateMultiPagePDF(tempContainer, pdfFilename);
    }

    async function shareApp() {
        if (!navigator.share) return alert('‡§∂‡•á‡§Ø‡§∞‡§ø‡§Ç‡§ó ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§');
        try {
            await navigator.share({ title: 'AI ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§ú‡•á‡§®‡§∞‡•á‡§ü‡§∞', text: '‡§á‡§∏ ‡§Ö‡§¶‡•ç‡§≠‡•Å‡§§ AI ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§ú‡•á‡§®‡§∞‡•á‡§ü‡§∞ ‡§ï‡•ã ‡§¶‡•á‡§ñ‡•á‡§Ç!', url: window.location.href });
        } catch (err) { console.error('‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø:', err); }
    }
    async function shareResults(score, totalScore) {
        if (!navigator.share) return alert('‡§∂‡•á‡§Ø‡§∞‡§ø‡§Ç‡§ó ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§');
        try {
            await navigator.share({ title: `${currentTopic} ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§ï‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ`, text: `‡§Æ‡•à‡§Ç‡§®‡•á '${currentTopic}' ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§Æ‡•á‡§Ç ${score}/${totalScore} ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§ï‡§ø‡§Ø‡§æ!`, url: window.location.href });
        } catch (err) { console.error('‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø:', err); }
    }
    const themeSwitchHandler = () => {
        const theme = themeToggle.checked ? 'dark' : 'light';
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
    };
    themeToggle.addEventListener('change', themeSwitchHandler);
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    themeToggle.checked = savedTheme === 'dark';
});
</script>
</body>
</html>